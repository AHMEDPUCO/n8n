stages:
  - security-scan
n8n-devsecops-trigger:
  stage: security-scan
  image: alpine:latest
  only:
    - pushes
  script:
    - apk add --no-cache curl
    - |
      curl -sS -X POST "$N8N_WEBHOOK_URL" \
        -H "Content-Type: application/json" \
        -d '{
          "event":"push",
          "project":"'"$CI_PROJECT_PATH"'",
          "commit":"'"$CI_COMMIT_SHA"'",
          "branch":"'"$CI_COMMIT_REF_NAME"'",
          "repo_http":"'"$CI_PROJECT_URL"'",
          "zap_target_url":"'"$ZAP_TARGET_URL"'"
        }'
